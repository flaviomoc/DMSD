---
title: "DMSD Vignette"
author: "FlÃ¡vio Mota"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{DMSD-vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## Loading data
```{r, fig.height = 5, fig.width = 8, fig.align = 'center',}
# Load packages
library(terra)
library(BAT)
library(SESraster)
library(DMSD)

# Load data
# Presence-absence SpatRaster
bin1 <- terra::rast(system.file("extdata", "ref.tif", package = "DMSD"))
bin2 <- terra::rast(system.file("extdata", "fut.tif", package = "DMSD"))

# Species traits
traits <- read.csv(system.file("extdata", "traits.csv", package = "DMSD"), row.names = 1)

# Phylogenetic tree
tree <- ape::read.tree(system.file("extdata", "tree.tre", package = "DMSD"))
```

## Alpha diversity
```{r, fig.height = 4, fig.width = 5, fig.align = 'center',}
# Taxonomic
alpha.td <- spat.alpha(bin1)
alpha.td
terra::plot(alpha.td)

# Functional
alpha.fd <- spat.alpha(bin1, traits)
alpha.fd
terra::plot(alpha.fd)

# Phylogenetic
alpha.pd <- spat.alpha(bin1, tree)
alpha.pd
terra::plot(alpha.pd)
```

## Standardize Effect Size
```{r, fig.height = 4, fig.width = 5, fig.align = 'center',}
# Functional
ses.fd <- spat.rand(bin1, traits, 10, "site")
ses.fd
terra::plot(ses.fd)

# Phylogenetic
ses.pd <- spat.rand(bin1, tree, 10, "site")
ses.pd
terra::plot(ses.pd)
```

## Spatial beta diversity
```{r, fig.height = 4, fig.width = 5, fig.align = 'center',}
# Taxonomic
beta.td <- spat.beta(bin1)
beta.td
terra::plot(beta.td)

# Functional
beta.fd <- spat.beta(bin1, traits)
beta.fd
terra::plot(beta.fd)

# Phylogenetic
beta.pd <- spat.beta(bin1, tree)
beta.pd
terra::plot(beta.pd)
```

## Temporal beta diversity
```{r, fig.height = 4, fig.width = 5, fig.align = 'center',}
# Taxonomic
betatemp.td <- temp.beta(bin1, bin2)
betatemp.td
terra::plot(betatemp.td)

# Functional
betatemp.fd <- temp.beta(bin1, bin2, traits)
betatemp.fd
terra::plot(betatemp.fd)

# Phylogenetic
betatemp.pd <- temp.beta(bin1, bin2, tree)
betatemp.pd
terra::plot(betatemp.pd)
```
